#!/usr/bin/env bash
# This script configures Nginx to redirect /redirect_me to a specified URL with a 301 status

# Update package list and install nginx if not installed
apt-get update -y
apt-get install -y nginx

# Ensure Nginx service is running
service nginx start

# Backup default site configuration
cp /etc/nginx/sites-available/default /etc/nginx/sites-available/default.bak

# Use sed to replace/add the location block for /redirect_me
sed -i '/server_name _;/a \
	    location /redirect_me {\
	            return 301 https://www.youtube.com/watch?v=QH2-TGUlwu4;\
		        }' /etc/nginx/sites-available/default

		# Test Nginx configuration
		nginx -t

		# Reload Nginx without systemctl
		service nginx reload
